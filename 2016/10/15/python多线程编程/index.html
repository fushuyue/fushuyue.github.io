<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>python多线程编程 | 长海冰茶火</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">python多线程编程</h1><a id="logo" href="/.">长海冰茶火</a><p class="description">很惭愧，做了一点微小的工作和笔记</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">python多线程编程</h1><div class="post-meta">Oct 15, 2016<span> | </span><span class="category"><a href="/categories/编程/">编程</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/10/15/python多线程编程/" href="/2016/10/15/python多线程编程/#comments" class="ds-thread-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一-概念"><span class="toc-number">1.</span> <span class="toc-text">一. 概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二-python-threading-模块编程"><span class="toc-number">2.</span> <span class="toc-text">二. python threading 模块编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-创建一个Thread实例"><span class="toc-number">2.1.</span> <span class="toc-text">1. 创建一个Thread实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Thread类的介绍"><span class="toc-number">2.2.</span> <span class="toc-text">2. Thread类的介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Lock"><span class="toc-number">2.3.</span> <span class="toc-text">3. Lock</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Condition-类"><span class="toc-number">2.4.</span> <span class="toc-text">4. Condition 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Semaphore-类"><span class="toc-number">2.5.</span> <span class="toc-text">5. Semaphore 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-Event-类"><span class="toc-number">2.6.</span> <span class="toc-text">6. Event 类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三-多线程的一个经典例子"><span class="toc-number">3.</span> <span class="toc-text">三. 多线程的一个经典例子</span></a></li></ol></div></div><div class="post-content"><h2 id="一-概念"><a href="#一-概念" class="headerlink" title="一. 概念"></a>一. 概念</h2><ul>
<li>进程是指程序执行时的一个实例，是资源分配的最小单位。<ul>
<li>不同进程之间使用的资源不同</li>
<li>可使用多核并行，不必担心GIL</li>
<li>适用于CPU-bound型任务</li>
<li>在windows下开启多进程速度较慢</li>
</ul>
</li>
<li>线程是程序执行时基本单元，或者说进程之内独立执行的一个单元执行流。<ul>
<li>与其余线程共享资源</li>
<li>收到GIL限制，无法利用多核</li>
<li>适用于I/O-bound型任务</li>
<li>共享资源的线程会同时崩溃</li>
</ul>
</li>
</ul>
<h2 id="二-python-threading-模块编程"><a href="#二-python-threading-模块编程" class="headerlink" title="二. python threading 模块编程"></a>二. python threading 模块编程</h2><h3 id="1-创建一个Thread实例"><a href="#1-创建一个Thread实例" class="headerlink" title="1. 创建一个Thread实例"></a>1. 创建一个Thread实例</h3><p>python官方文档：</p>
<blockquote>
<p>The Thread class represents an activity that is run in a separate thread of control.<br>There are two ways to specify the activity: </p>
<ol>
<li>Passing a callable object to the constructor</li>
<li>Overriding the run() method in a subclass. No other methods (except for the constructor) should be overridden in a subclass. In other words, only override the <code>__init__()</code> and run() methods of this class.</li>
</ol>
</blockquote>
<p>第一种方法是将一个可执行对象传递给threading.Thread类来创建一个新的对象</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> time, threading</div><div class="line"></div><div class="line"><span class="comment"># 新线程执行的代码:</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">loop</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'thread %s is running...'</span> % threading.current_thread().name)</div><div class="line">    n = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> n &lt; <span class="number">5</span>:</div><div class="line">        n = n + <span class="number">1</span></div><div class="line">        print(<span class="string">'thread %s &gt;&gt;&gt; %s'</span> % (threading.current_thread().name, n))</div><div class="line">        time.sleep(<span class="number">1</span>)</div><div class="line">    print(<span class="string">'thread %s ended.'</span> % threading.current_thread().name)</div><div class="line"></div><div class="line">print(<span class="string">'thread %s is running...'</span> % threading.current_thread().name)</div><div class="line">t = threading.Thread(target=loop, name=<span class="string">'LoopThread'</span>)</div><div class="line">t.start()</div><div class="line">t.join()</div><div class="line">print(<span class="string">'thread %s ended.'</span> % threading.current_thread().name)</div></pre></td></tr></table></figure>
<p>第二种方法是利用继承创建一个自定义的多线程类，重载threading.Thread中的<code>__init__()</code> and run()</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">myThread</span> <span class="params">(threading.Thread)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, threadID, name, q)</span>:</span></div><div class="line">        threading.Thread.__init__(self)</div><div class="line">        self.threadID = threadID</div><div class="line">        self.name = name</div><div class="line">        self.q = q</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"Starting "</span> + self.name</div><div class="line">        process_data(self.name, self.q)</div><div class="line">        <span class="keyword">print</span> <span class="string">"Exiting "</span> + self.name</div></pre></td></tr></table></figure>
<p>注意，在自定义类前必须声明<code>Thread.__init__()</code></p>
<h3 id="2-Thread类的介绍"><a href="#2-Thread类的介绍" class="headerlink" title="2. Thread类的介绍"></a>2. Thread类的介绍</h3><figure class="highlight fortran"><table><tr><td class="code"><pre><div class="line"><span class="keyword">class</span> threading.Thread(group=<span class="keyword">None</span>, <span class="keyword">target</span>=<span class="keyword">None</span>, <span class="keyword">name</span>=<span class="keyword">None</span>,\</div><div class="line">                       args=(), kwargs=&#123;&#125;, *, daemon=<span class="keyword">None</span>)</div></pre></td></tr></table></figure>
<p>group：必须为None<br>target：一个用于执行 run() 的可执行对象.<br>name：线程名称，默认为“Thread-N”<br>args/kwargs: 要传入方法的参数</p>
<p>一些有用的官方说明：</p>
<blockquote>
<p>Once a thread object is created, its activity must be started by calling the thread’s start() method. This invokes the run() method in a separate thread of control.<br>Other threads can call a thread’s join() method. This blocks the calling thread until the thread whose join() method is called is terminated.<br>A thread can be flagged as a “daemon thread”. The significance of this flag is that the entire Python program exits when only daemon threads are left. The initial value is inherited from the creating thread. The flag can be set through the daemon property or the daemon constructor argument.</p>
</blockquote>
<p>一些有用的实例方法：<br><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">start()               <span class="comment"># start the thread's activity</span></div><div class="line">join(timeout=<span class="keyword">None</span>)    <span class="comment"># Wait until the thread terminates.</span></div><div class="line">is_alive()			  <span class="comment"># Return whether the thread is alive.</span></div><div class="line">getName()</div><div class="line">isDaemon()</div></pre></td></tr></table></figure></p>
<h3 id="3-Lock"><a href="#3-Lock" class="headerlink" title="3. Lock"></a>3. Lock</h3><p>在多线程中，所有线程共享内存，所以存在将变量改乱的可能性，因此引入lock的概念。<br>可以认为Lock有一个锁定池，当线程请求锁定时，将线程至于池中，直到获得锁定后出池。池中的线程处于状态图中的同步阻塞状态。</p>
<blockquote>
<p>A primitive lock is in one of two states, “locked” or “unlocked”. It is created in the unlocked state.<br>It has two basic methods, acquire() and release().<br>When the state is unlocked, acquire() changes the state to locked and returns immediately.<br>When the state is locked, acquire() blocks until a call to release() in another thread changes it to unlocked, then the acquire() call resets it to locked and returns. </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment"># 全局ThreadLocal对象:</span></div><div class="line"><span class="keyword">import</span> threading</div><div class="line"></div><div class="line">lock = threading.Lock()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_thread</span><span class="params">(n)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>):</div><div class="line">        <span class="comment"># 先要获取锁:</span></div><div class="line">        lock.acquire()</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            <span class="comment"># 放心地改吧:</span></div><div class="line">            change_it(n)</div><div class="line">        <span class="keyword">finally</span>:</div><div class="line">            <span class="comment"># 改完了一定要释放锁:</span></div><div class="line">            lock.release()</div></pre></td></tr></table></figure>
<p>RLock：可重入锁</p>
<blockquote>
<p>A reentrant lock is a synchronization primitive that may be acquired multiple times by the same thread.</p>
</blockquote>
<p>acquire()/release()的次数必须相同</p>
<h3 id="4-Condition-类"><a href="#4-Condition-类" class="headerlink" title="4. Condition 类"></a>4. Condition 类</h3><figure class="highlight sql"><table><tr><td class="code"><pre><div class="line">class threading.Condition(<span class="keyword">lock</span>=<span class="keyword">None</span>)</div><div class="line"><span class="string">``</span><span class="string">` </span></div><div class="line"></div><div class="line">一个condition变量允许一个或多个线程等待直到他们被其余线程通知可以继续执行</div><div class="line">实例方法：</div><div class="line">`<span class="string">``</span>python</div><div class="line">acquire(*args)      # 获得锁</div><div class="line"><span class="keyword">release</span>()           # 释放锁</div><div class="line"><span class="keyword">wait</span>(<span class="keyword">timeout</span>=<span class="keyword">None</span>)  # <span class="keyword">Wait</span> <span class="keyword">until</span> notified <span class="keyword">or</span> <span class="keyword">until</span> a <span class="keyword">timeout</span> occurs</div><div class="line">wait_for(predicate, <span class="keyword">timeout</span>=<span class="keyword">None</span>)    # <span class="keyword">Wait</span> <span class="keyword">until</span> a condition evaluates <span class="keyword">to</span> <span class="literal">True</span></div><div class="line">notify(n=<span class="number">1</span>)         # wake up one <span class="keyword">thread</span> waiting <span class="keyword">on</span> this condition,</div><div class="line">notify_all()</div></pre></td></tr></table></figure>
<h3 id="5-Semaphore-类"><a href="#5-Semaphore-类" class="headerlink" title="5. Semaphore 类"></a>5. Semaphore 类</h3><blockquote>
<p>A semaphore manages an internal counter which is decremented by each acquire() call and incremented by each release() call.<br>The counter can never go below zero; when acquire() finds that it is zero, it blocks, waiting until some other thread calls release().</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">threading</span>.<span class="title">Semaphore</span><span class="params">(value=<span class="number">1</span>)</span></span></div></pre></td></tr></table></figure>
<p>semaphore创建一个计数器代表release()-acquire()+value.被call的次数。如果计数器返回值小于零，acquire()将被block</p>
<h3 id="6-Event-类"><a href="#6-Event-类" class="headerlink" title="6. Event 类"></a>6. Event 类</h3><p>线程间通信的最简单方式之一。</p>
<blockquote>
<p>Class implementing event objects. An event manages a flag that can be set to true with the set() method and reset to false with the clear() method. The wait() method blocks until the flag is true. The flag is initially false.</p>
</blockquote>
<figure class="highlight"><table><tr><td class="code"><pre><div class="line">class threading.Event</div><div class="line">is_set()    # 返回True如果内部flag为正</div><div class="line">set()       # 将内部flag设为正</div><div class="line">clear()     # 将内部flag设为负</div><div class="line">wait()      # 当flag为负时block</div></pre></td></tr></table></figure>
<h2 id="三-多线程的一个经典例子"><a href="#三-多线程的一个经典例子" class="headerlink" title="三. 多线程的一个经典例子"></a>三. 多线程的一个经典例子</h2><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> time </div><div class="line"><span class="keyword">import</span> threading </div><div class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Queue</div><div class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span><span class="params">(threading.Thread)</span>:</span> </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, queue)</span>:</span> </div><div class="line">        threading.Thread.__init__(self)</div><div class="line">        self._queue = queue </div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>: </div><div class="line">            content = self._queue.get() </div><div class="line">            <span class="keyword">if</span> isinstance(content, str) <span class="keyword">and</span> content == <span class="string">'quit'</span>:</div><div class="line">                <span class="keyword">break</span></div><div class="line">            response = urllib2.urlopen(content)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Producer</span><span class="params">()</span>:</span></div><div class="line">    urls = [<span class="string">"http://www.google.com/"</span>,<span class="string">"http://www.baidu.com/"</span>]</div><div class="line"></div><div class="line">    queue = Queue()</div><div class="line">    worker_threads = build_worker_pool(queue, <span class="number">4</span>)</div><div class="line">    start_time = time.time()</div><div class="line"></div><div class="line">    <span class="comment"># Add the urls to process</span></div><div class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls: </div><div class="line">        queue.put(url)  </div><div class="line">    <span class="comment"># Add the poison pillv</span></div><div class="line">    <span class="keyword">for</span> worker <span class="keyword">in</span> worker_threads:</div><div class="line">        queue.put(<span class="string">'quit'</span>)</div><div class="line">    <span class="keyword">for</span> worker <span class="keyword">in</span> worker_threads:</div><div class="line">        worker.join()</div><div class="line"></div><div class="line">    print(<span class="string">'Done! Time taken: &#123;&#125;'</span>.format(time.time() - start_time))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_worker_pool</span><span class="params">(queue, size)</span>:</span></div><div class="line">    workers = []</div><div class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(size):</div><div class="line">        worker = Consumer(queue)</div><div class="line">        worker.start() </div><div class="line">        workers.append(worker)</div><div class="line">    <span class="keyword">return</span> workers</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    Producer()</div></pre></td></tr></table></figure>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2016/10/15/python多线程编程/" data-id="civix2ade0004et61jqxjg9h8" class="article-share-link">分享到</a><div class="tags"><a href="/tags/python/">python</a><a href="/tags/threading/">threading</a></div><div class="post-nav"><a href="/2016/10/15/利用卷积神经网络学习CIFAR10/" class="pre">利用卷积神经网络学习CIFAR10</a></div><div data-thread-key="2016/10/15/python多线程编程/" data-title="python多线程编程" data-url="http://yoursite.com/2016/10/15/python多线程编程/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/10/15/python多线程编程/" data-title="python多线程编程" data-url="http://yoursite.com/2016/10/15/python多线程编程/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/python爬虫/">python爬虫</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/期权/">期权</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/深度学习/">深度学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程/">编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/量化交易/">量化交易</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/urllib/" style="font-size: 15px;">urllib</a> <a href="/tags/RNN/" style="font-size: 15px;">RNN</a> <a href="/tags/threading/" style="font-size: 15px;">threading</a> <a href="/tags/multiprocessing/" style="font-size: 15px;">multiprocessing</a> <a href="/tags/爬虫/" style="font-size: 15px;">爬虫</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/quant/" style="font-size: 15px;">quant</a> <a href="/tags/cnn/" style="font-size: 15px;">cnn</a> <a href="/tags/cuda/" style="font-size: 15px;">cuda</a> <a href="/tags/择时/" style="font-size: 15px;">择时</a> <a href="/tags/RL/" style="font-size: 15px;">RL</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/11/02/RNN笔记/">RNN笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/量化策略评价体系/">量化策略评价体系</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/scrapy库学习/">scrapy库学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/择时体系梳理/">择时体系梳理</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/22/requests库/">requests库</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/22/urllib库学习/">urllib库学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/21/深度强化学习笔记/">深度强化学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/19/复权问题处理/">复权问题处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/python多进程编程/">python多进程编程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/python_With_statement/">With statement in python</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 关于我</i></div><ul></ul><a href="http://www.github.com/fushuyue" title="Github" target="_blank">Github</a><ul></ul><a href="https://www.linkedin.com/in/fushuyue" title="Linkedin" target="_blank">Linkedin</a><ul></ul><a href="sfu11@illinois.edu" title="Email" target="_blank">Email</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">长海冰茶火.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'fushuyue'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>